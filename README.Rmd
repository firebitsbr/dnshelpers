---
output: rmarkdown::github_document
---

# dnshelpers

Tools to Process 'DNS' Response Data

## Description

The internet domain name system ('DNS') supports a wide variety of response types besides simple 'IP' addresses or domain names. Methods are provided to process a myriad of other response data elements including 'DMARC' ('TXT'), 'SPF' ('TXT'), 'MX' and more.

## What's Inside The Tin

The following functions are implemented:

- `parse_dmarc`:	Parse DMARCv1 DNS data reponses into a data frame
- `parse_mx`:	Parse MX DNS data reponses into a data frame
- `parse_soa`:	Parse SOA DNS data reponses into a data frame
- `parse_spf`:	Parse SPF TXT DNS data reponses into a list

## Installation

```{r eval=FALSE}
devtools::install_github("hrbrmstr/dnshelpers")
```

```{r message=FALSE, warning=FALSE, error=FALSE, include=FALSE}
options(width=120)
```

## Usage

```{r message=FALSE, warning=FALSE, error=FALSE}
library(dnshelpers)
library(gdns)
library(tidyverse)

# current verison
packageVersion("dnshelpers")

```

```{r}
targets <- c("senate.gov", "equifax.com", "rapid7.com")

bulk_query(targets, "MX") %>% 
  bind_cols(parse_mx(.$data))

bulk_query(targets, "SOA") %>% 
  bind_cols(parse_soa(.$data))

bulk_query(sprintf("_dmarc.%s", targets), "TXT") %>% 
  filter(str_detect(str_to_lower(data), "dmarc1")) %>% 
  bind_cols(parse_dmarc(.$data))

bulk_query(targets, "TXT") %>% 
  filter(str_detect(str_to_lower(data), "v=spf")) %>% 
  .$data %>% 
  parse_spf() %>% 
  str()
```
